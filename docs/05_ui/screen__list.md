# 画面一覧と画面状態+機能概要

## 全体
URL単位での画面一覧
|No.|画面ID|画面名|
|:--:|:--:|:--:|
|1|SCR-01|ログイン画面|
|2|SCR0-2|チャット画面|
|3|SCR-03|管理画面|
|4|SCR-04|ダッシュボード-運用|
|5|SCR-05|ダッシュボード-分析|
|6|SCR-06|ユーザー管理|
|7|SCR-07|ログ|

## ログイン (SCR-01)
### 画面状態
|No.|モードID|モード名|説明|
|:--:|:--:|:--:|---|
|1|SCR-01-M01|ログイン|ログインフォーム表示|
|2|SCR-01-M02|新規登録|新規登録フォーム表示|
|3|SCR-01-M03|PWリセット|パスワード再設定|
### 機能一覧
|No.|機能ID|機能名|説明|
|:--:|:--:|:--:|---|
|1|FN-A01|ログイン|認証を行いセッションを開始|
|2|FN-A02|新規登録|ユーザーアカウント作成|
|3|FN-A03|パスワードリセット|PW再設定|
|4|FN-A04|ログアウト|共通|
___

## チャット (SCR-02)
### 画面状態
|No.|モードID|モード名|説明|
|:--:|:--:|:--:|---|
|1|SCR-02-M01|通常チャット|LLM単体で応答|
|2|SCR-02-M02|RAGチャット|ドキュメント検索を伴う応答|
|3|SCR-02-M03|スレッド未選択|初期状態・新規作成|
|4|SCR-02-M04|スレッド編集中|タイトル変更・削除|
### 機能一覧（チャット）
|No.|機能ID|機能名|説明|
|:--:|:--:|:--:|---|
|1|FN-B01|スレッド一覧取得|ユーザーのスレッド一覧を取得|
|2|FN-B02|スレッド作成|新しい会話スレッド作成|
|3|FN-B03|メッセージ送信|入力メッセージを送信|
|4|FN-B04|メッセージ取得|スレッドの会話履歴取得|
|5|FN-B05|RAG応答生成|検索付き応答生成|
|6|FN-B06|スレッド編集|タイトル変更・削除|
|7|FN-B07|回答評価|LLMからの回答についてGood/Bad評価|
___

## 管理画面 (SCR-03)
### 画面状態一覧
|No.|モードID|モード名|説明|
|:--:|:--:|:--:|---|
|1|SCR-03-M01|通常表示|管理トップ画面（各管理機能への入口）|
|2|SCR-03-M02|文章登録モーダル表示|RAG用文章の新規登録を行う|
|3|SCR-03-M03|文章一覧モーダル表示|登録済み文章の一覧・管理|
### 機能一覧（管理：RAG文章管理）
|No.|機能ID|機能名|説明|
|:--:|:--:|:--:|---|
|1|FN-C01|文章登録|RAG検索対象となる文章を登録する|
|2|FN-C02|文章一覧取得|登録済み文章の一覧を取得する|
|3|FN-C03|文章有効/無効切替|RAG検索対象に含めるかを制御する|
|4|FN-C04|再インデックス|文章に紐づくEmbeddingを再生成する|
|5|FN-C05|文章メタ情報取得|チャンク数・トークン数などを取得する|
|6|FN-C06|文章削除（論理削除）|文章を無効化し検索対象から除外する|
|7|FN-C07|登録失敗情報取得|登録・再インデックス失敗情報を取得する|
|8|FN-C08|再インデックス進捗取得|再インデックス処理の進捗を取得する|

__

## ダッシュボード-運用(SCR-04)
### 画面状態一覧
| No. |    モードID   | モード名        | 説明                         |
| :-: | :--------: | :---------- | -------------------------- |
|  1  | SCR-04-M01 | KPIサマリー表示   | DAU・RAG利用率など主要KPIをカード表示    |
|  2  | SCR-04-M02 | 利用状況モニタリング  | スレッド数／メッセージ数 × アクティブユーザー推移 |
|  3  | SCR-04-M03 | RAG品質モニタリング | RAGヒット率・再質問率など品質指標         |
|  4  | SCR-04-M04 | 属性別利用状況     | 部署別ランキング表示                 |
|  5  | SCR-04-M05 | コストモニタリング   | 推定コスト・累計コスト表示              |


### 機能一覧
| No. |  機能ID  | 機能名       | 説明                             |
| :-: | :----: | :-------- | ------------------------------ |
|  1  | FN-D01 | KPIサマリー取得 | DAU / RAG利用率 / 利用継続率 / 応答時間を取得 |
|  2  | FN-D02 | 利用状況集計    | メッセージ数・スレッド数・アクティブユーザー数取得      |
|  3  | FN-D03 | RAG利用判定   | RAG使用有無・RAG利用率を算出              |
|  4  | FN-D04 | RAG品質指標算出 | ヒット率・再質問率・平均参照チャンク数            |
|  5  | FN-D05 | 部署別利用集計   | 部署別の利用量ランキング取得                 |
|  6  | FN-D06 | コスト集計     | 日次／月次推定コスト算出                   |
|  7  | FN-D07 | 閾値判定      | KPIが設定閾値を超過／下回ったか判定            |
|  8  | FN-D08 | 状態表現      | 正常／注意／異常のステータス付与               |

## ダッシュボード-分析(SCR-05)
### 画面状態一覧
| No. |    モードID   | モード名        | 説明                         |
| :-: | :--------: | :---------- | -------------------------- |
|  1  | SCR-05-M01 | フィルターエリア   | フィルター項目：期間、部署、RAG利用有無、文章ID、応答時間レンジ、と＾勲数レンジ、エラー有無    |
|  2  | SCR-05-M02 | 利用率・定着率  | スレッド数／メッセージ数 × アクティブユーザー推移 |
|  3  | SCR-05-M03 |  | RAGヒット率・再質問率など品質指標         |
|  4  | SCR-05-M04 | 属性別利用状況     | 部署別ランキング表示                 |
|  5  | SCR-05-M05 | コストモニタリング   | 推定コスト・累計コスト表示              |
### 機能一覧
| No. |  機能ID  | 機能名             | 説明                                           |
| :-: | :----: | --------------- | -------------------------------------------- |
|  1  | FN-E01 | 分析ダッシュボード表示     | 分析用ダッシュボードページを表示する                           |
|  2  | FN-E02 | 期間フィルター         | 分析対象期間を指定する（日付From/To、デフォルトは直近30日）           |
|  3  | FN-E03 | 部門フィルター         | dep1→dep2→dep3のカスケード選択で対象部門を絞り込む（NULL＝未所属含む） |
|  4  | FN-E04 | ユーザー属性フィルター     | ユーザー種別（一般/管理者など）で分析対象を切り替える                  |
|  5  | FN-E05 | モデルフィルター        | 使用LLMモデル別に分析対象を切り替える                         |
|  6  | FN-E06 | RAG ON/OFFフィルター | RAG利用有無でメッセージ・ユーザーを絞り込む                      |
|  7  | FN-E07 | DAU/WAU/MAU推移表示 | アクティブユーザー数を日次・週次・月次で可視化する                    |
|  8  | FN-E08 | チャット利用推移表示      | メッセージ数・ユーザー数の推移を連動した折れ線で表示する                 |
|  9  | FN-E09 | 1ユーザーあたり平均利用数算出 | 平均メッセージ数/ユーザーを算出・表示する                        |
|  10 | FN-E10 | 継続率分析表示         | 7日・30日継続率を棒グラフで可視化する                         |
|  11 | FN-E11 | RAG利用率推移表示      | 文章検索モード利用率を時系列で表示する                          |
|  12 | FN-E12 | 文章別参照回数ランキング    | RAG文章ごとの参照回数・平均参照チャンク数を一覧表示する                |
|  13 | FN-E13 | 文章別ヒット率表示       | 検索候補に含まれた回数に対するヒット率を算出・表示する                  |
|  14 | FN-E14 | RAG未ヒット率分析      | RAGモード時にチャンクがヒットしなかった割合を表示する                 |
|  15 | FN-E15 | コスト推移表示         | トークン数×単価によるコスト推移を日次・週次・月次で表示する               |
|  16 | FN-E16 | 部門別コスト分析        | 部門単位でのコスト集計・比較を行う                            |
|  17 | FN-E17 | 入力/出力トークン内訳表示   | 入力・出力トークン数および金額内訳を表示する                       |
|  18 | FN-E18 | エラー発生状況分析       | エラー種別ごとの発生状況を時系列で表示する                        |
|  19 | FN-E19 | エラー率算出          | 総メッセージ数に対するエラー発生率を算出する                       |
|  20 | FN-E20 | 詳細ログ画面遷移        | 分析画面からログ詳細ページへ遷移する                           |
|  21 | FN-E21 | グラフ単位切替         | 日次／週次／月次の表示単位をタブで切り替える                       |
|  22 | FN-E22 | マウスオーバー詳細表示     | グラフ・テーブル上で人数・回数・率などの詳細を表示する                  |
|  23 | FN-E23 | データ集計条件リセット     | 適用中のフィルター条件を初期状態に戻す                          |


## ユーザー管理 (SCR-06)
### 画面状態一覧
|No. | モードID | モード名        | 説明                  |
|:--:| :-----: | :----------- | ------------------- |
|1| SCR-06-M01 | ユーザー管理一覧     | フィルター＋ユーザー一覧テーブルを表示 |
|2| SCR-06-M02 | ユーザー編集モーダル   | 既存ユーザーの情報編集         |
|3| SCR-06-M03 | 新規ユーザー登録モーダル | 新規ユーザー登録（編集モーダルの流用） |
### 機能一覧
|No.|   機能ID  | 機能名         | 説明                      |
|:---:| :-----: | ----------- | ----------------------- |
|1| FN-F01 | ユーザー検索      | キーワード（社員番号・氏名）による部分一致検索 |
|2| FN-F02 | 部門フィルター     | 部門1→2→3のカスケード選択         |
|3| FN-F03 | 権限フィルター     | 権限（admin / user 等）で絞り込み |
|4| FN-F04 | ユーザー一覧取得    | 条件に基づくユーザー一覧取得          |
|5| FN-F05 | ページネーション    | ページ切替（limit / offset）   |
|6| FN-F06 | ユーザー詳細表示    | 行クリックで編集モーダルを表示         |
|7| FN-F07 | ユーザー情報更新    | 氏名・部門・権限・登録状況の更新        |
|8| FN-F08 | 部門マニュアル入力切替 | トグルONで部門1~3を自由入力に変更     |
|9| FN-F09 | 登録状況切替      | 有効 / 無効（論理削除ではない）       |
|10| FN-F10 | パスワードリセット   | 対象ユーザーのPWを再設定           |
|11| FN-F11 | ユーザー削除      | 理論削除 / アカウント無効化         |
|12| FN-F12 | 新規ユーザー登録    | 新規ユーザーの作成               |
|13| FN-F13 | 初期パスワード設定   | 登録時の初期PW設定 or 自動発行      |
|14|  共通-F14 | 入力バリデーション   | 必須・文字数・形式チェック           |
|15|  共通-F15 | 権限制御        | 管理者のみ実行可能な操作制御          |
|16|  共通-F16 | 操作ログ出力      | 更新・削除・PWリセットの監査ログ       |

## ログ (SCR-07)
### 画面状態一覧

|No.| モードID | モード名    | 説明            |
|:---:| :-----: | -------- | ------------- |
|1|  SCR-07-M01 | システムログ一覧 | 検索条件＋ログ一覧テーブル |
|2|  SCR-07-M02 | ログ詳細モーダル | 1件のログ詳細を表示    |

### 機能一覧
|No.|   機能ID  | 機能名         | 説明                                 |
|:---:| :-----: | ----------- | ---------------------------------- |
|1| FN-G01 | ログ一覧取得      | 条件に基づきログを取得                        |
|2| FN-G02 | 期間フィルター     | 日時From/To指定                        |
|3| FN-G03 | ログ種別フィルター   | ユーザー操作 / RAG / 認証 / システム           |
|4| FN-G04 | 操作種別フィルター   | CREATE / UPDATE / DELETE / RESET 等 |
|5| FN-G05 | 操作者フィルター    | 操作者（ユーザーID・氏名）                     |
|6| FN-G06 | 対象ユーザーフィルター | 操作対象ユーザー                           |
|7| FN-G07 | キーワード検索     | 自由テキスト検索（備考・エラー内容）                 |
|8| FN-G08 | ページネーション    | ページ切替                              |
|9| FN-G09 | ログ詳細表示      | 行クリックで詳細モーダル表示                     |
|10| FN-G10 | リクエスト情報表示   | API・method・status code             |
|11| FN-G11 | 変更内容表示      | Before / After（差分）                 |
|12| FN-G12 | エラー詳細表示     | スタックトレース・メッセージ                     |
|13|  FN-G13 | 権限制御        | 管理者のみ閲覧可                           |
|14|  FN-G14 | CSVエクスポート   | 検索結果をCSV出力（任意）                     |
